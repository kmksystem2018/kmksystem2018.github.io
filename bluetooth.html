<!DOCTYPE html>
<html lang="hu">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Web Bluetooth</title>
    <style>
        body { font-family: Arial, sans-serif; text-align: center; padding: 20px; }
        button { padding: 10px 20px; margin: 10px; font-size: 18px; cursor: pointer; }
        #status { margin-top: 20px; font-size: 18px; font-weight: bold; }
    </style>
</head>
<body>

    <h1>Web Vez√©rl≈ë</h1>
    <button onclick="connectToweb()">üîó Csatlakoz√°s az eszk√∂z√∂zz</button>
    <div id="status">‚ö†Ô∏è Nem csatlakozt√°l</div>

    <h2>Motorvez√©rl√©s</h2>
    <button onclick="moveMotor(0x00, 50)">‚¨ÜÔ∏è Motor A El≈ëre</button>
    <button onclick="moveMotor(0x00, -50)">‚¨áÔ∏è Motor A H√°tra</button>
<br>
    <button onclick="start()>START</button>
    <br>
    <button onclick="moveMotor(0x01, 50)">‚û°Ô∏è Motor B El≈ëre</button>
    <button onclick="moveMotor(0x01, -50)">‚¨ÖÔ∏è Motor B H√°tra</button>
    <br>
    <button onclick="stopMotor()">üõë Stop</button>

    <script>
        let webCharacteristic;

        async function connectToweb() {
            try {
                const device = await navigator.bluetooth.requestDevice({
                    acceptAllDevices: true,
                    optionalServices: ['00001623-1212-efde-1623-785feabcd123']
                });

                const server = await device.gatt.connect();
                const service = await server.getPrimaryService('00001623-1212-efde-1623-785feabcd123');
                webCharacteristic = await service.getCharacteristic('00001624-1212-efde-1623-785feabcd123');

                document.getElementById('status').innerText = "‚úÖ Sikeres csatlakoz√°s!";
                console.log("‚úÖ csatlakoztatva!");
            } catch (error) {
                console.error("‚ùå Hiba t√∂rt√©nt:", error);
                document.getElementById('status').innerText = "‚ùå Hiba a csatlakoz√°skor!";
            }
        }
	function start(){
		moveMotor(0x00, 50)
        moveMotor(0x01, 50)}

        async function moveMotor(port, speed) {
            if (!webCharacteristic) {
                alert("üîå El≈ësz√∂r csatlakozz!");
                return;
            }
            const command = new Uint8Array([0x08, 0x00, 0x81, port, 0x11, 0x51, 0x00, speed]);
            await webCharacteristic.writeValue(command);
            console.log(`üîß Motor ${port === 0x00 ? "A" : "B"} mozg√°sba hozva ${speed} sebess√©ggel!`);
        }

        async function stopMotor() {
            if (!webCharacteristic) {
                alert("üîå El≈ësz√∂r csatlakozz!");
                return;
            }
            const command = new Uint8Array([0x08, 0x00, 0x81, 0x00, 0x11, 0x51, 0x00, 0x00]);
            await webCharacteristic.writeValue(command);
            console.log("üõë Motorok le√°ll√≠tva!");
        }
    </script>

</body>
</html>
